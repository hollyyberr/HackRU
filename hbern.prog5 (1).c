// Holly Bernich - CSCI1110-01-Program 5
// Create a Auto Tracking Expense Program Version 4


#include <stdio.h>
#include <stdlib.h>

#define SENTINEL 99
#define lengthOfArray 500;

//Prototypes
int monthValidate (int month);
int dayValidate (int day,int month,int year);
int yearValidate (int year);


//-------------------------------------------------
int main(void)
{
    // Create and initialize local variables
    int month=0;
    int day=0;
    int year=0;
    int odometerNumber=0;
    double costAmount=0.0;
    int saveOdometerNumber=0;
    int firstOdometer=-1;
    double totalCost=0.0;
    int monthError=0;
    int yearError=0;
    int dayError=0;
    int increment=0;
    int monthArray[500];
    int dayArray[500];
    int yearArray[500];
    int odometerArray[500];
    double costArray[500];
    int odometerError=0;
    //Print one time headers
    printf("Holly Bernich, Isabella Chiaravalloti, Veronica Marquez - HackRU Program \n");
    printf("Creating an auto tracking expense program for one year of driving using a data set from 365 days a year: \n");
    printf("To exit, enter all 99\n\n");


    //Start the loop for reading input
    while(1)
    {
        odometerError=0;
        //Enter Input
        printf("\n Enter the MMDDYear OdometerNumber Cost$: ");
        scanf("%2d %2d %4d %6d %lg",&month,&day,&year,&odometerNumber,&costAmount);

        //Check for errors and end per SENTINEL
        if(SENTINEL==month)break;


        //Error Check: Odometer
        if (saveOdometerNumber < odometerNumber)
            saveOdometerNumber=odometerNumber;
        else
            odometerError=1;


        //computations
        if(firstOdometer==-1)
        {
            firstOdometer=odometerNumber;
        }
        dayError=dayValidate(day,month,year);
         yearError=yearValidate(year);
        monthError=monthValidate(month);
        if(yearError==0 && monthError==0 && dayError==0 && odometerError==0)
        {
            yearArray[increment]=year;
            monthArray[increment]=month;
            dayArray[increment]=day;
            odometerArray[increment]=odometerNumber;
            costArray[increment]=costAmount;
            increment++;
        }
        else{
        printf("| %02i %02i %04i |      %06i      | %7.2f |",month,day,year,odometerNumber,costAmount);


        if (monthError==1) printf("month error");


        if (yearError==1) printf("year error");


        if (dayError==1) printf("day error");

        if (saveOdometerNumber > odometerNumber)
            printf("odometer error");
            saveOdometerNumber=odometerNumber;

        }
        //print output, aligned


    }
    printf("|--------------------------------------------|\n");
    printf("| MM DD YYYY |   Odometer Number  |   Cost   |\n");
    printf("|--------------------------------------------|\n");
    int i;
    for(i=0;i<increment;++i)
{
 printf("| %02i %02i %04i |       %06i       |  %7.2f |\n",monthArray[i],dayArray[i],yearArray[i],odometerArray[i],costArray[i]);
    totalCost+=costArray[i];
}


    printf("\n|--------------------------------------------|");
    printf("\n|Miles Driven/Year|");    printf("    %d      |----------|",saveOdometerNumber-firstOdometer);
    printf("\n|Total Cost/Year  |");    printf("    %lg    |----------|", totalCost);
    printf("\n|Avg $$/Mile/Year |");    printf("    %.1lg        |----------|", totalCost/saveOdometerNumber);
    printf("\n|Avg Cost/Month   |"); printf("    %lg    |----------|",(totalCost/12));
    printf("\n|--------------------------------------------|\n");
    return 0;
}
//-----------------------------------------------------------
int monthValidate(int month)
{
    int error=0;
    if (month<0 || month>12) error=1;
    return error;
}

//-----------------------------------------------------------
int yearValidate(int year)
{
    int error=0;
    if (year<1900 || year>2035) error=1;
    return error;
}

//-----------------------------------------------------------
int dayValidate(int day,int month,int year)
{
    int leapYear;
    int numberOfDays;
    int error=0;
    if (month==4 || month==6 || month==9 || month==11)
        numberOfDays=30;
    else if (month==2)
    {
        leapYear=((year%4==0 && year%100!=0) || year%400==0);
        if(leapYear)
        {

            numberOfDays=29;
        }
        else
        {

            numberOfDays=28;
        }
    }
    else
        numberOfDays=31;
    if(numberOfDays<day)
        error=1;
    return error;
}
/*
Copy and paste sample data set of auto tracking into program
01012018 000032 2.65
01022018 000068 5.73
01032018 000149 10.34
01042018 000201 204.53
01052018 000206 0.70
01062018 000283 6.79
01072018 000301 2.34
01082018 000356 4.32
01092018 000375 1.87
01102018 000389 1.63
01112018 000401 1.98
01122018 000435 2.87
01132018 000501 6.32
01142018 000562 5.78
01152018 000604 3.54
01162018 000672 4.99
01172018 000723 10.72
01182018 000748 2.36
01192018 000782 4.32
01202018 000789 0.65
01212018 000830 3.21
01222018 000847 2.43
01232018 000867 1.98
01242018 001145 10.43
01252018 001200 3.46
01262018 001234 2.54
01272018 001257 2.10
01282018 001310 3.45
01292018 001365 5.43
01302018 001378 1.76
01312018 001391 2.01
02012018 001479 0.45
02022018 001523 5.73
02032018 001589 4.76
02042018 001632 4.62
02052018 001660 2.34
02062018 001693 2.12
02072018 001724 2.78
02082018 001762 4.32
02092018 001801 4.21
02102018 001808 1.11
02112018 001870 5.33
02122018 001899 2.21
02132018 001932 2.75
02142018 001960 2.43
02152018 002104 11.70
02162018 002186 8.97
02172018 002230 5.21
02182018 002252 1.77
02192018 002292 2.65
02202018 002340 5.30
02212018 002373 73.45
02222018 002389 1.06
02232018 002433 2.89
02242018 002499 5.60
02252018 002650 4.97
02262018 002698 3.61
02272018 002732 3.01
02282018 002780 6.49
02292018 002813 2.34
02302018 002890 5.44
02312018 002934 4.11
03012018 003016 4.89
03022018 003078 3.66
03032018 003099 2.31
03042018 003106 1.76
03052018 003122 2.11
03062018 003128 0.33
03072018 003129 0.02
03082018 003168 3.01
03092018 003195 2.44
03102018 003199 0.88
03112018 003204 0.33
03122018 003216 1.24
03132018 003219 0.77
03142018 003225 0.55
03152018 003289 4.33
03162018 003297 1.30
03172018 003300 0.40
03182018 003309 0.98
03192018 003317 0.77
03202018 003368 3.60
03212018 003369 0.20
03222018 003379 1.01
03232018 003390 1.20
03242018 003396 1.33
03252018 003399 0.40
03262018 003401 0.56
0372018 003499 6.70
03282018 003508 1.01
03292018 003512 0.70
03302018 003519 0.44
03312018 003588 4.66
04012018 003612 3.44
04022018 003619 0.99
04032018 003659 2.80
04042018 003689 2.55
04052018 003705 2.31
04062018 003798 7.50
04072018 003806 1.32
04082018 003809 0.30
04092018 003817 0.33
04102018 003899 3.60
04112018 003902 0.11
04122018 003908 0.33
04132018 003912 0.30
04142018 003920 0.42
04152018 003960 3.22
04162018 003988 2.60
04172018 003990 1.17
04182018 004009 1.01
04192018 004018 0.80
04202018 004090 5.50
04212018 004100 1.01
04222018 004108 0.77
04232018 004200 5.02
04242018 004205 0.17
04252018 004215 0.81
04262018 004218 0.33
04272018 004270 0.90
04282018 004278 0.33
04292018 004290 0.40
04302018 004295 0.44
04312018 004300 0.42
05012018 004320 1.20
05022018 004329 0.80
05032018 004380 3.26
05042018 004397 2.11
05052018 004400 0.77
05062018 004425 2.25
05072018 004482 6.77
05082018 004490 2.33
05092018 004510 2.20
05102018 004740 14.50
05112018 004819 10.01
05122018 004822 0.33
05132018 004826 0.45
05142018 005002 12.11
05152018 005496 30.98
05162018 005593 24.50
05172018 005604 60.98
05182018 005650 2.98
05192018 005762 12.44
05202018 005788 3.45
05212018 005801 23.43
05222018 005877 12.22
05232018 005901 8.09
05242018 00599910.99
05252018 006200 45.66
05262018 006740 50.67
05272018 006744 12.33
05282018 006780 88.09
05292018 006782 3.01
05302018 006831 2.33
05312018 006840 0.88
06012018 006850 1.33
06022018 006859 0.98
06032018 006989 2.33
06042018 006990 0.12
06052018 006999 0.77
06062018 007058 2.21
06072018 007085 2.34
06082018 007098 1.12
06092018 007105 0.99
06102018 007180 5.66
06112018 007208 2.23
06122018 007290 4.44
06132018 007309 2.29
06142018 007319 1.12
06152018 007325 0.76
06162018 007372 0.99
06172018 007396 1.12
06182018 007450 3.41
06192018 007466 1.45
06202018 007493 3.01
06212018 007520 19.87
06222018 007560 4.33
06232018 007590 2.76
06242018 007600 3.34
06252018 007890 1.12
06262018 007952 50.67
06272018 008000 2.21
06282018 008064 4.45
06292018 008095 2.66
06302018 008109 2.43
06312018 008128 2.15
07012018 008154 2.75
07022018 008160 1.11
07032018 008198 2.33
07042018 008206 1.09
07052018 008295 5.66
07062018 008365 4.44
07072018 008394 3.42
07082018 008722 30.54
07092018 008800 12.45
07102018 008899 7.88
07112018 008974 32.54
07122018 009000 3.01
07132018 009500 35.66
07142018 009800 18.98
07152018 009844 3.33
07162018 009858 1.28
07172018 009861 0.77
07182018 009950 0.90
07192018 010000 4.41
07202018 010589 39.98
07212018 010987 38.76
07222018 010999 1.33
07232018 011459 36.77
07242018 011487 3.21
07252018 011489 0.99
07262018 011987 39.08
07272018 011999 1.23
07282018 012045 4.56
07292018 012546 37.86
07302018 012548 0.55
07312018 012549 0.10
08012018 012697 11.20
08022018 012789 16.90
08032018 012799 .70
08042018 013066 20.00
08052018 013589 39.25
08062018 013598 1.70
08072018 013690 7.50
08082018 013999 22.50
08092018 014058 4.25
08102018 014098 2.45
08112018 014105 1.50
08122018 014106 .07
08132018 014107 .08
08142018 014108 .07
08152018 014109 .08
08162018 014150 3.75
08172018 014189 2.95
08182018 014200 .90
08192018 014300 7.50
08202018 014345 3.35
08212018 014358 .97
08222018 014398 3.00
08232018 014420 1.65
08242018 014465 3.35
08252018 014480 1.85
08262018 014490 1.70
08272018 014501 .85
08282018 014521 1.50
08292018 014589 5.10
08302018 014605 1.20
08312018 014608 .20
09012018 014638 2.10
09022018 014689 3.50
09032018 014789 7.00
09042018 014801 .84
09052018 014824 1.60
09062018 014856 2.25
09072018 014870 .98
09082018 014892 .85
09092018 014900 1.25
09102018 014980 5.60
09112018 015000 1.40
09122018 015065 4.55
09132018 015097 2.10
09142018 015098 .14
09152018 015099 .21
09162018 015109 .70
09172018 015110 5.60
09182018 015111 24.05
09192018 015112 5.60
09202018 015113 3.40
09212018 015114 .28
09222018 015115 .14
09232018 015116  .70
09242018 015119 .42
09252018 015127 .56
09262018 015146 1.40
09272018 015172 2.10
09282018 015185 .91
09292018 015194 .98
09302018 015198 .28
09312018 015199 .07
10012018 016000 500.00
10022018 016005 .35
10032018 016015 .70
10042018 016058 3.80
10052018 016069 .77
10062018 016098 2.10
10072018 016100 .84
10082018 016108 .49
10092018 016115 .49
10102018 016119 .28
10112018 016138 1.40
10122018 016189 3.50
10132018 016200 .77
10142018 016205 .35
10152018 016242 2.80
10162018 016258 .90
10172018 016298  2.10
10182018 016300 .14
10192018 016365 30.50
10202018 016389 2.10
10212018 016390 .07
10222018 016398 .56
10232018 016410 .84
10242018 016429 1.35
10252018 016480 4.2
10262018 016485 .35
10272018 016500 1.05
10282018 016555 3.85
10292018 016581 2.10
10302018 016585 56.00
10312018 016600  1.05
11012018 016654 3.78
11022018 016681 3.80
11032018 016732 5.60
11042018 016798 3.60
11052018 016843 3.15
11062018 016897 3.50
11072018 016956 10.50
11082018 017006 4.00
11092018 017043 2.80
11102018 017097 4.50
11112018 017138 2.80
11122018 017198 4.20
11132018 017256 3.00
11142018 017288 2.10
11152018 017312 2.10
11162018 017344 2.10
11172018 017456 12.00
11182018 017499 2.25
11192018 017506 1.25
11202018 017547 4.50
11212018 017588 2.80
11222018 017634 3.25
11232018 017645 8.90
11242018 017698 10.25
11252018 017744 3.50
11262018 017768 1.75
11272018 017794 5.65
11282018 018001 12.35
11292018 018034 24.50
11302018 018076 2.80
11312018 018098 1.85
12012018 018176 2.10
12022018 018194 3.20
12032018 018293 45.50
12042018 018344 3.50
12052018 018367 1.60
12062018 018398 2.10
12072018 018450 2.80
12082018 018477 1.40
12092018 018562 1.20
12102018 018588 1.50
12112018 018672 1.40
12122018 018774 .14
12132018 018792 1.40
12142018 018803 .77
12152018 018844 2.80
12162018 018866 1.40
12172018 018943 5.00
12182018 018998 12.00
12192018 019045 3.50
12202018 019077 2.10
12212018 019083 1.35
12222018 019156 2.10
12232018 019178 1.65
12242018 019234 2.80
12252018 019289 16.50
12262018 019344 4.92
12272018 019390 4.36
12282018 019455 5.22
12292018 019472 2.34
12302018 019533 5.66
12312018 019578 3.36
99999999 999999 99
*/
